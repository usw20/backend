package com.phantom.security.repository;

import com.phantom.security.model.MalwareScanLog;
import org.springframework.data.domain.Sort;
import org.springframework.data.mongodb.repository.MongoRepository;
import org.springframework.stereotype.Repository;

import java.time.LocalDateTime;
import java.util.List;

@Repository
public interface MalwareScanLogRepository extends MongoRepository<MalwareScanLog, String> {

    /**
     * 사용자별 악성코드 탐지 이력 조회 (최신 순)
     */
    List<MalwareScanLog> findByUserIdOrderByDetectedAtDesc(String userId);

    /**
     * 사용자별 악성코드 탐지 이력 조회 (페이징)
     */
    List<MalwareScanLog> findByUserId(String userId, Sort sort);

    /**
     * 사용자별 특정 기간 내 악성코드 탐지 이력 조회
     */
    List<MalwareScanLog> findByUserIdAndDetectedAtBetween(String userId, LocalDateTime startDate, LocalDateTime endDate);

    /**
     * 사용자별 특정 스캔 결과만 조회
     */
    List<MalwareScanLog> findByUserIdAndScanResult(String userId, String scanResult);

    /**
     * 특정 기기의 스캔 로그 조회
     */
    List<MalwareScanLog> findByUserIdAndDeviceId(String userId, String deviceId);

    /**
     * 사용자별 악성코드 탐지 건수 조회
     */
    long countByUserIdAndScanResult(String userId, String scanResult);

    /**
     * 사용자별 전체 스캔 건수 조회
     */
    long countByUserId(String userId);
}