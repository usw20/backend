package com.phantom.security.model;

import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;
import org.springframework.data.mongodb.core.index.Indexed;
import java.time.LocalDateTime;

@Document(collection = "malware_scan_logs")
public class MalwareScanLog {

    @Id
    private String id;

    @Indexed
    private String userId;

    private String deviceId;

    private String scanType; // "realtime" or "manual"

    private String targetPackageName;

    private String targetHash;

    private String scanResult; // "safe", "malicious", "suspicious"

    private String threatName;

    @Indexed
    private LocalDateTime detectedAt = LocalDateTime.now();

    private Boolean isBlocked;

    // 기본 생성자
    public MalwareScanLog() {}

    // 생성자
    public MalwareScanLog(String userId, String deviceId, String scanType,
                          String targetPackageName, String targetHash) {
        this.userId = userId;
        this.deviceId = deviceId;
        this.scanType = scanType;
        this.targetPackageName = targetPackageName;
        this.targetHash = targetHash;
    }

    // Getter와 Setter
    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }

    public String getUserId() {
        return userId;
    }

    public void setUserId(String userId) {
        this.userId = userId;
    }

    public String getDeviceId() {
        return deviceId;
    }

    public void setDeviceId(String deviceId) {
        this.deviceId = deviceId;
    }

    public String getScanType() {
        return scanType;
    }

    public void setScanType(String scanType) {
        this.scanType = scanType;
    }

    public String getTargetPackageName() {
        return targetPackageName;
    }

    public void setTargetPackageName(String targetPackageName) {
        this.targetPackageName = targetPackageName;
    }

    public String getTargetHash() {
        return targetHash;
    }

    public void setTargetHash(String targetHash) {
        this.targetHash = targetHash;
    }

    public String getScanResult() {
        return scanResult;
    }

    public void setScanResult(String scanResult) {
        this.scanResult = scanResult;
    }

    public String getThreatName() {
        return threatName;
    }

    public void setThreatName(String threatName) {
        this.threatName = threatName;
    }

    public LocalDateTime getDetectedAt() {
        return detectedAt;
    }

    public void setDetectedAt(LocalDateTime detectedAt) {
        this.detectedAt = detectedAt;
    }

    public Boolean getIsBlocked() {
        return isBlocked;
    }

    public void setIsBlocked(Boolean isBlocked) {
        this.isBlocked = isBlocked;
    }
}